rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * Core Philosophy: This ruleset establishes a clear separation between publicly
     * readable content and private, admin-managed data. The core security model
     * allows any user, including unauthenticated visitors, to read product and
     * company information. All write operations (creating,
     * updating, deleting) are disabled on the client side.
     *
     * Data Structure: The data is organized into two distinct, top-level
     * collections:
     * - /products: Public catalog of all products.
     * - /companyProfiles: Public information about the company.
     *
     * Key Security Decisions:
     * - Public Read, No Writes: `products` and `companyProfiles` are globally
     *   readable to support the public-facing website. All modifications are
     *   locked down from the client.
     *
     * Denormalization for Authorization: This ruleset does not require
     * denormalization as access controls are collection-wide.
     *
     * Structural Segregation: The use of separate top-level collections for
     * `products` and `companyProfiles` provides a strong security boundary.
     */

    /**
     * @description Publicly readable product catalog.
     * @path /products/{productId}
     * @allow (get) Any user, signed-in or not, can read a specific product.
     * @deny (create) All client-side writes are denied.
     * @principle Public read access for catalog data, with all writes disabled.
     */
    match /products/{productId} {
      allow get: if true;
      allow list: if true;
      allow write: if false;
    }

    /**
     * @description Publicly readable company profile information.
     * @path /companyProfiles/{companyProfileId}
     * @allow (list) Any user, signed-in or not, can list all company profiles.
     * @deny (update) All client-side writes are denied.
     * @principle Public read access for company info, with all writes disabled.
     */
    match /companyProfiles